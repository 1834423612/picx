var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,s=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,l=(e,t)=>{for(var a in t||(t={}))i.call(t,a)&&s(e,a,t[a]);if(n)for(var a of n(t))o.call(t,a)&&s(e,a,t[a]);return e},r=(e,n)=>t(e,a(n));import{E as d,a as u,b as c,c as g,d as p,e as m,f,g as I,h,i as _,j as C,k as v,l as L,m as D,n as b,o as U,p as A,q as S,r as k,s as O,t as E,u as y,v as T,w,x as R,y as M,z as P,A as G,B as x,C as N,D as V,F as $,G as j,H as z,I as F,J as X,K as B,L as H,M as Y,N as J,O as q,P as W,Q as K,R as Q,S as Z,T as ee,U as te,V as ae,W as ne,X as ie,Y as oe,Z as se,_ as le,$ as re,a0 as de,a1 as ue,a2 as ce,a3 as ge,a4 as pe}from"./vendor.f122fabb.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const me={},fe=function(e,t){return t&&0!==t.length?Promise.all(t.map((e=>{if((e=`./${e}`)in me)return;me[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const n=document.createElement("link");return n.rel=t?"stylesheet":"modulepreload",t||(n.as="script",n.crossOrigin=""),n.href=e,document.head.appendChild(n),t?new Promise(((e,t)=>{n.addEventListener("load",e),n.addEventListener("error",t)})):void 0}))).then((()=>e())):e()};const Ie={state:{name:"dirImageListModule",dirImageList:(()=>{const e=localStorage.getItem("PICX_MANAGEMENT");return e?JSON.parse(e):[]})()},mutations:{},actions:{DIR_IMAGE_LIST_ADD_IMAGE({state:e,dispatch:t},a){const n=e.dirImageList.find((e=>e.dir===a.dir));n&&(n.imageList.push(a),t("DIR_IMAGE_LIST_PERSIST"))},DIR_IMAGE_LIST_ADD_IMAGE_LIST({state:e,dispatch:t},a){const n=e.dirImageList.find((e=>e.dir===a.dir));n?n.imageList=a.imageList:e.dirImageList.unshift(a),t("DIR_IMAGE_LIST_PERSIST")},DIR_IMAGE_LIST_ADD_DIR({state:e,dispatch:t},a){if(!e.dirImageList.some((e=>e.dir===a))){const n={dir:a,imageList:[]};"/"===a?e.dirImageList.unshift(n):e.dirImageList.push(n),t("DIR_IMAGE_LIST_PERSIST")}},DIR_IMAGE_LIST_REMOVE_DIR({state:e,dispatch:t},a){if(e.dirImageList.some((e=>e.dir===a))){const n=e.dirImageList.findIndex((e=>e.dir===a));e.dirImageList.splice(n,1),t("DIR_IMAGE_LIST_PERSIST")}},DIR_IMAGE_LIST_REMOVE({state:e,dispatch:t},a){if(e.dirImageList.length>0){const n=e.dirImageList.find((e=>e.dir===a.dir));if(n){const e=n.imageList.findIndex((e=>e.uuid===a.uuid));-1!==e&&(n.imageList.splice(e,1),0===n.imageList.length&&(t("DIR_IMAGE_LIST_REMOVE_DIR",n.dir),t("USER_CONFIG_INFO_REMOVE_DIR",n.dir)),t("DIR_IMAGE_LIST_PERSIST"))}}},DIR_IMAGE_LIST_PERSIST({state:e}){localStorage.setItem("PICX_MANAGEMENT",JSON.stringify(e.dirImageList))},DIR_IMAGE_LOGOUT({state:e}){e.dirImageList=[],localStorage.removeItem("PICX_MANAGEMENT")}},getters:{getDirImageList:e=>e.dirImageList}},he={state:{curImgBase64Url:"",curImgUuid:"",list:[],uploadedNumber:0},actions:{TO_UPLOAD_IMAGE_LIST_ADD({state:e},t){e.list.unshift(t)},TO_UPLOAD_IMAGE_SET_CURRENT({state:e},{uuid:t,base64Url:a}){e.curImgUuid=t,e.curImgBase64Url=a},TO_UPLOAD_IMAGE_UPLOADED({state:e}){e.uploadedNumber+=1},TO_UPLOAD_IMAGE_LIST_REMOVE({state:e},t){if(e.list.length>0){const a=e.list.findIndex((e=>e.uuid===t));if(-1!==a&&e.list.splice(a,1),0===e.list.length)e.curImgBase64Url="",e.uploadedNumber=0;else if(e.curImgUuid===t){const t=e.list[0];e.curImgBase64Url=t.imgData.base64Url,e.curImgUuid=t.uuid}}},TO_UPLOAD_IMAGE_LIST_FAIL({state:e}){if(e.list.length>0){const t=e.list.filter((e=>100!==e.uploadStatus.progress));t.length>0&&(e.list=t,e.uploadedNumber=0,e.curImgBase64Url=t[0].imgData.base64Url)}},TO_UPLOAD_IMAGE_CLEAN_URL({state:e}){e.curImgBase64Url=""},TO_UPLOAD_IMAGE_CLEAN_LIST({state:e}){e.list=[]},TO_UPLOAD_IMAGE_CLEAN_UPLOADED_NUMBER({state:e}){e.uploadedNumber=0},TO_UPLOAD_IMAGE_LOGOUT({state:e}){e.curImgBase64Url="",e.list=[],e.uploadedNumber=0}},getters:{getToUploadImageList:e=>e.list,getToUploadImage:e=>e}},_e={state:{uploadedImageList:(()=>{const e=sessionStorage.getItem("PICX_UPLOADED");return e?JSON.parse(e):[]})()},mutations:{},actions:{UPLOADED_LIST_ADD({state:e,dispatch:t},a){e.uploadedImageList.unshift(a),t("UPLOADED_LIST_PERSIST")},UPLOADED_LIST_REMOVE({state:e,dispatch:t},a){if(e.uploadedImageList.length>0){const n=e.uploadedImageList.findIndex((e=>e.uuid===a.uuid));-1!==n&&(e.uploadedImageList.splice(n,1),t("UPLOADED_LIST_PERSIST"))}},UPLOADED_LIST_PERSIST({state:e}){sessionStorage.setItem("PICX_UPLOADED",JSON.stringify(e.uploadedImageList))},UPLOADED_LIST_LOGOUT({state:e}){e.uploadedImageList=[],sessionStorage.removeItem("PICX_UPLOADED")}},getters:{getUploadedImageList:e=>e.uploadedImageList}},Ce=e=>{const t=Object.prototype.toString.call(e).split(" ")[1];return t.substring(0,t.length-1).toLowerCase()},ve=e=>{for(const t in e)switch(Ce(e[t])){case"object":ve(e[t]);break;case"string":e[t]="";break;case"array":e[t]=[];break;case"number":e[t]=0;break;case"boolean":e[t]=!1}},Le=y({modules:{dirImageListModule:Ie,toUploadImageModule:he,uploadedImageListModule:_e,userConfigInfoModule:{state:{userConfigInfo:(()=>{const e=localStorage.getItem("PICX_CONFIG");return e?JSON.parse(e):{token:"",owner:"",email:"",name:"",avatarUrl:"",selectedRepos:"",reposList:[],selectedBranch:"",dirMode:"",selectedDir:"",dirList:[],loggingStatus:!1}})()},actions:{SET_USER_CONFIG_INFO({state:e},t){for(const a in t)e.userConfigInfo.hasOwnProperty(a)&&(e.userConfigInfo[a]=t[a])},USER_CONFIG_INFO_ADD_DIR({state:e,dispatch:t},a){e.userConfigInfo.dirList.some((e=>e.value===a))||(e.userConfigInfo.dirList.push({label:a,value:a}),t("USER_CONFIG_INFO_PERSIST"))},USER_CONFIG_INFO_REMOVE_DIR({state:e,dispatch:t},a){const{dirList:n}=e.userConfigInfo;if(n.some((e=>e.value===a))){const e=n.findIndex((e=>e.value===a));n.splice(e,1),t("USER_CONFIG_INFO_PERSIST")}},USER_CONFIG_INFO_PERSIST({state:e}){e.userConfigInfo.selectedDir=e.userConfigInfo.selectedDir.replace(/\s+/g,"-"),localStorage.setItem("PICX_CONFIG",JSON.stringify(e.userConfigInfo))},USER_CONFIG_INFO_LOGOUT({state:e}){ve(e.userConfigInfo),localStorage.removeItem("PICX_CONFIG")}},getters:{getUserLoggingStatus:e=>e.userConfigInfo.loggingStatus,getUserConfigInfo:e=>e.userConfigInfo}},imageViewerModule:{state:{imageViewer:{url:"",isShow:!1}},mutations:{IMAGE_VIEWER(e,{url:t,isShow:a}){e.imageViewer.url=t,e.imageViewer.isShow=a},IMAGE_VIEWER_LOGOUT(e){e.imageViewer.isShow=!1,e.imageViewer.url=""}},actions:{},getters:{getImageViewer:e=>e.imageViewer}},uploadAreaActiveModule:{state:{uploadAreaActive:!1},mutations:{CHANGE_UPLOAD_AREA_ACTIVE(e,t){e.uploadAreaActive=t},UPLOAD_AREA_ACTIVE_LOGOUT(e){e.uploadAreaActive=!1}},actions:{},getters:{getUploadAreaActive:e=>e.uploadAreaActive}},uploadSettingsModule:{state:{uploadSettings:{isSetMaxSize:!0,imageMaxSize:30720}},mutations:{UPLOAD_SETTINGS_LOGOUT(e){e.uploadSettings.isSetMaxSize=!0,e.uploadSettings.imageMaxSize=30720}},actions:{},getters:{getUploadSettings:e=>e.uploadSettings}}},state:{rootName:"root"},mutations:{},actions:{LOGOUT({dispatch:e,commit:t}){e("DIR_IMAGE_LOGOUT"),e("TO_UPLOAD_IMAGE_LOGOUT"),e("UPLOADED_LIST_LOGOUT"),e("USER_CONFIG_INFO_LOGOUT"),t("IMAGE_VIEWER_LOGOUT"),t("UPLOAD_AREA_ACTIVE_LOGOUT"),t("UPLOAD_SETTINGS_LOGOUT")}},getters:{}}),De=Symbol("vue-store");function be(){return T(De)}var Ue,Ae;(Ae=Ue||(Ue={})).autoDir="autoDir",Ae.newDir="newDir",Ae.rootDir="rootDir",Ae.reposDir="reposDir";const Se=w.create({baseURL:"https://api.github.com",timeout:3e5});Se.interceptors.request.use((e=>{const t=window.localStorage.getItem("accessToken");return t&&(e.headers.common.Authorization=t),e}),(e=>Promise.reject(e))),Se.interceptors.response.use((e=>e),(e=>{if(e.response&&e.response.data){const t=e.response.status,a=e.response.data.message;R.error(`Code: ${t}, Message: ${a}`),console.error("[PicX Error]",e.response)}else R.error(`${e}`);return e.response}));class ke{static zerofill(e){return e<10?`0${e}`:e}static getYyyyMmDd(e=Date.now()){const t=new Date(e),a=t.getFullYear(),n=t.getMonth()+1,i=t.getDate();return`${a}${this.zerofill(n)}${this.zerofill(i)}`}static formatTimestamp(e=Date.now()){const t=new Date(e),a=t.getFullYear(),n=t.getMonth()+1,i=t.getDate(),o=t.getHours(),s=t.getMinutes(),l=t.getSeconds();return`${a}-${this.zerofill(n)}-${this.zerofill(i)} ${this.zerofill(o)}:${this.zerofill(s)}:${this.zerofill(l)}`}}var Oe=M({name:"config",setup(){const e=P(),t=be(),a=G({userConfigInfo:x((()=>t.getters.getUserConfigInfo)).value,loggingStatus:x((()=>t.getters.getUserConfigInfo)).value,loading:!1,dirLoading:!1,getUserInfo(){this.userConfigInfo.token?(this.loading=!0,Se.get("/user",{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((e=>{e&&200===e.status?(this.saveUserInfo(e),this.getReposList(e.data.repos_url)):this.loading=!1}))):R.warning("Token 不能为空！")},saveUserInfo(e){this.userConfigInfo.loggingStatus=!0,this.userConfigInfo.owner=e.data.login,this.userConfigInfo.name=e.data.name,this.userConfigInfo.email=e.data.email,this.userConfigInfo.avatarUrl=e.data.avatar_url,this.persistUserConfigInfo()},getReposList(e){Se.get(e,{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((e=>{if(200===e.status&&e.data.length>0){this.userConfigInfo.reposList=[];for(const t of e.data)t.fork||this.userConfigInfo.reposList.push({value:t.name,label:t.name,desc:t.description});this.loading=!1,this.persistUserConfigInfo()}}))},innerSelectRepos(e){a.getBranchList(e),a.persistUserConfigInfo()},getBranchList(e){this.dirLoading=!0,Se.get(`/repos/${this.userConfigInfo.owner}/${e}/branches`,{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((t=>{if(t&&200===t.status){this.dirLoading=!1;const a="master",n="main";t.data.length>0?(t.data.some((e=>e.name===a))?this.userConfigInfo.selectedBranch=a:t.data.some((e=>e.name===n))&&(this.userConfigInfo.selectedBranch=n),this.getDirList(e)):(this.userConfigInfo.selectedBranch=a,this.userConfigInfo.dirMode=Ue.newDir,this.userConfigInfo.selectedDir="",this.userConfigInfo.dirList=[])}}))},getDirList(e){this.dirLoading=!0,Se.get(`/repos/${this.userConfigInfo.owner}/${e}/contents`,{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((e=>{if(e&&200===e.status&&e.data.length>0){this.userConfigInfo.dirList=[{value:"/",label:"/"}];for(const t of e.data)"dir"===t.type&&this.userConfigInfo.dirList.push({value:t.name,label:t.name});this.persistUserConfigInfo()}this.dirLoading=!1}))},innerDirModeChange(e){switch(e){case Ue.rootDir:this.userConfigInfo.selectedDir="/";break;case Ue.autoDir:this.userConfigInfo.selectedDir=ke.getYyyyMmDd();break;case Ue.newDir:case Ue.reposDir:this.userConfigInfo.selectedDir="";break;default:this.userConfigInfo.selectedDir="/"}this.persistUserConfigInfo()},persistUserConfigInfo(){t.dispatch("USER_CONFIG_INFO_PERSIST")},reset(){this.loading=!1,this.dirLoading=!1,t.dispatch("LOGOUT")},innerGoUpload(){const{selectedDir:t,dirMode:a}=this.userConfigInfo;let n="目录不能为空！";if(""===t){switch(a){case Ue.newDir:n="请在输入框输入一个新目录！";break;case Ue.reposDir:n=`请选择 ${this.userConfigInfo.selectedRepos} 仓库下的一个目录！`;break;default:n="请在输入框输入一个新目录！"}R.warning(n)}else e.push("/upload")}});return N((()=>a.loggingStatus),(e=>{e||(a.loading=!1,a.dirLoading=!1)})),r(l({},V(a)),{dirModeChange:e=>{a.innerDirModeChange(e)},selectRepos:e=>{a.innerSelectRepos(e)},goUpload:()=>{a.innerGoUpload()}})}});$("data-v-91909156");const Ee={class:"page-container config-page-container"},ye=ee(" 确认 Token "),Te=ee("新建目录"),we=ee("根目录"),Re=ee("自动目录"),Me=ee(" 重置 "),Pe=ee("完成配置 ");var Ge,xe;j(),Oe.render=function(e,t,a,n,i,o){const s=z("el-input"),l=z("el-form-item"),r=z("el-button"),d=z("el-form"),u=z("el-option"),c=z("el-select"),g=z("el-radio"),p=z("el-tooltip"),m=z("el-radio-group"),f=F("loading");return X(),B("div",Ee,[H(d,{"label-width":"70px","label-position":"right",class:"config-form"},{default:Y((()=>[H(l,{label:"Token"},{default:Y((()=>[H(s,{modelValue:e.userConfigInfo.token,"onUpdate:modelValue":t[0]||(t[0]=t=>e.userConfigInfo.token=t),clearable:"",autofocus:!e.userConfigInfo.token},null,8,["modelValue","autofocus"])])),_:1}),H(l,{class:"operation"},{default:Y((()=>[H(r,{plain:"",size:"small",type:"primary","native-type":"submit",onClick:t[1]||(t[1]=K((t=>e.getUserInfo()),["prevent"]))},{default:Y((()=>[ye])),_:1})])),_:1})])),_:1}),e.userConfigInfo.token?J((X(),q(d,{key:0,"label-width":"70px","label-position":"right","element-loading-text":"加载中..."},{default:Y((()=>[e.userConfigInfo.owner?(X(),q(l,{key:0,label:"用户名"},{default:Y((()=>[H(s,{modelValue:e.userConfigInfo.owner,"onUpdate:modelValue":t[2]||(t[2]=t=>e.userConfigInfo.owner=t),readonly:""},null,8,["modelValue"])])),_:1})):W("",!0),e.userConfigInfo.email?(X(),q(l,{key:1,label:"邮箱"},{default:Y((()=>[H(s,{modelValue:e.userConfigInfo.email,"onUpdate:modelValue":t[3]||(t[3]=t=>e.userConfigInfo.email=t),readonly:""},null,8,["modelValue"])])),_:1})):W("",!0),e.userConfigInfo.reposList.length?(X(),q(l,{key:2,label:"选择仓库"},{default:Y((()=>[H(c,{modelValue:e.userConfigInfo.selectedRepos,"onUpdate:modelValue":t[4]||(t[4]=t=>e.userConfigInfo.selectedRepos=t),filterable:"",style:{width:"100%"},placeholder:"请选择图床仓库...",onChange:e.selectRepos},{default:Y((()=>[(X(!0),B(Q,null,Z(e.userConfigInfo.reposList,((e,t)=>(X(),q(u,{key:t,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1})):W("",!0)])),_:1},512)),[[f,e.loading]]):W("",!0),e.userConfigInfo.selectedRepos?J((X(),q(d,{key:1,"label-width":"70px","label-position":"right","element-loading-text":"加载中..."},{default:Y((()=>[e.userConfigInfo.reposList.length&&e.userConfigInfo.selectedRepos?(X(),q(l,{key:0,label:"目录方式"},{default:Y((()=>[H(m,{modelValue:e.userConfigInfo.dirMode,"onUpdate:modelValue":t[5]||(t[5]=t=>e.userConfigInfo.dirMode=t),onChange:e.dirModeChange},{default:Y((()=>[H(p,{content:"手动输入一个新目录",placement:"top"},{default:Y((()=>[H(g,{label:"newDir"},{default:Y((()=>[Te])),_:1})])),_:1}),H(p,{content:"图片存储在 "+e.userConfigInfo.selectedBranch+" 分支的根目录下",placement:"top"},{default:Y((()=>[H(g,{label:"rootDir"},{default:Y((()=>[we])),_:1})])),_:1},8,["content"]),H(p,{content:"根据日期自动创建格式 YYYYMMDD 的目录",placement:"top"},{default:Y((()=>[H(g,{label:"autoDir"},{default:Y((()=>[Re])),_:1})])),_:1}),e.userConfigInfo.dirList.length?(X(),q(p,{key:0,content:"选择 "+e.userConfigInfo.selectedRepos+" 仓库下的一个目录",placement:"top"},{default:Y((()=>[H(g,{label:"reposDir"},{default:Y((()=>[ee("选择 "+te(e.userConfigInfo.selectedRepos)+" 仓库目录",1)])),_:1})])),_:1},8,["content"])):W("",!0)])),_:1},8,["modelValue","onChange"])])),_:1})):W("",!0),"autoDir"===e.userConfigInfo.dirMode?(X(),q(l,{key:1,label:"自动目录"},{default:Y((()=>[H(s,{modelValue:e.userConfigInfo.selectedDir,"onUpdate:modelValue":t[6]||(t[6]=t=>e.userConfigInfo.selectedDir=t),readonly:""},null,8,["modelValue"])])),_:1})):W("",!0),"rootDir"===e.userConfigInfo.dirMode?(X(),q(l,{key:2,label:"根目录"},{default:Y((()=>[H(s,{modelValue:e.userConfigInfo.selectedDir,"onUpdate:modelValue":t[7]||(t[7]=t=>e.userConfigInfo.selectedDir=t),readonly:""},null,8,["modelValue"])])),_:1})):W("",!0),"newDir"===e.userConfigInfo.dirMode?(X(),q(l,{key:3,label:"新建目录"},{default:Y((()=>[H(s,{modelValue:e.userConfigInfo.selectedDir,"onUpdate:modelValue":t[8]||(t[8]=t=>e.userConfigInfo.selectedDir=t),onInput:t[9]||(t[9]=t=>e.persistUserConfigInfo()),clearable:"",placeholder:"请输入新建的目录..."},null,8,["modelValue"])])),_:1})):W("",!0),e.userConfigInfo.dirList.length&&"reposDir"===e.userConfigInfo.dirMode?(X(),q(l,{key:4,label:"选择目录"},{default:Y((()=>[H(c,{modelValue:e.userConfigInfo.selectedDir,"onUpdate:modelValue":t[10]||(t[10]=t=>e.userConfigInfo.selectedDir=t),filterable:"",style:{width:"100%"},placeholder:"请选择目录...",onChange:e.persistUserConfigInfo},{default:Y((()=>[(X(!0),B(Q,null,Z(e.userConfigInfo.dirList,(e=>(X(),q(u,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])),_:1})):W("",!0)])),_:1},512)),[[f,e.dirLoading]]):W("",!0),H(d,{"label-width":"70px"},{default:Y((()=>[H(l,{class:"operation"},{default:Y((()=>[e.userConfigInfo.owner?(X(),q(r,{key:0,plain:"",size:"small",onClick:t[11]||(t[11]=t=>e.reset())},{default:Y((()=>[Me])),_:1})):W("",!0),e.userConfigInfo.selectedRepos?(X(),q(r,{key:1,plain:"",size:"small",type:"success",onClick:e.goUpload},{default:Y((()=>[Pe])),_:1},8,["onClick"])):W("",!0)])),_:1})])),_:1})])},Oe.__scopeId="data-v-91909156",(xe=Ge||(Ge={})).gh="gh",xe.md_gh="md_gh",xe.cdn="cdn",xe.md_cdn="md_cdn";var Ne=M({name:"copy-external-link",props:{imgObj:{type:Object,default:()=>({})}},setup:e=>({copyExternalLink:function(t){let a="",n="";switch(t){case Ge.gh:e.imgObj.is_transform_md?(a=e.imgObj.md_gh_url,n="Markdown 格式的 GitHub"):(a=e.imgObj.github_url,n="GitHub");break;case Ge.cdn:e.imgObj.is_transform_md?(a=e.imgObj.md_cdn_url,n="Markdown 格式的 CDN"):(a=e.imgObj.cdn_url,n="CDN")}let i=document.querySelector(".temp-external-link");i||(i=document.createElement("textarea"),i.setAttribute("class","temp-external-link"),i.style.position="absolute",i.style.top="-99999px",i.style.left="-99999px",document.body.appendChild(i)),i.value=a,i.select(),document.execCommand("copy"),R.success(`${n} 外链复制成功！`)},transformMD:function(){e.imgObj.is_transform_md=!e.imgObj.is_transform_md},externalLinkType:Ge})});$("data-v-0977da75");const Ve={class:"copy-external-link-box"};j(),Ne.render=function(e,t,a,n,i,o){const s=z("el-tooltip");return X(),B("div",Ve,[H(s,{content:e.imgObj.is_transform_md?"已转换 Markdown 格式":"转换 Markdown 格式",placement:"top"},{default:Y((()=>[ae("span",{class:ne(["btn-item transform-btn",{"is-transform":e.imgObj.is_transform_md}]),onClick:t[0]||(t[0]=t=>e.transformMD())}," MD ",2)])),_:1},8,["content"]),H(s,{content:"点击复制 GitHub 外链",placement:"top"},{default:Y((()=>[ae("span",{class:"btn-item copy-url",onClick:t[1]||(t[1]=t=>e.copyExternalLink(e.externalLinkType.gh))}," GitHub ")])),_:1}),H(s,{content:"点击复制 CDN 外链",placement:"top"},{default:Y((()=>[ae("span",{class:"btn-item copy-url",onClick:t[2]||(t[2]=t=>e.copyExternalLink(e.externalLinkType.cdn))}," CDN ")])),_:1})])},Ne.__scopeId="data-v-0977da75";var $e=M({name:"image-card",components:{copyExternalLink:Ne},props:{listing:{type:Boolean,default:!1},imageObj:{type:Object,default:()=>{}},isUploaded:{type:Boolean,default:!1}},setup(){const e=be(),t=G({isEnableDeleted:!0,userConfigInfo:x((()=>e.getters.getUserConfigInfo)).value,deleteImage(e){ie.confirm(`此操作将会永久删除 ${e.name} ？`,"删除提示",{confirmButtonText:"确定",cancelButtonText:"取消",iconClass:"el-icon-warning"}).then((()=>{this.doDeleteImage(e)})).catch((()=>{console.log("取消删除")}))},doDeleteImage(t){var a,n,i,o,s;t.deleting=!0,Se.delete(`/repos/${null==(a=this.userConfigInfo)?void 0:a.owner}/${null==(n=this.userConfigInfo)?void 0:n.selectedRepos}/contents/${t.path}`,{headers:{"Content-Type":"application/json",Authorization:`token ${null==(i=this.userConfigInfo)?void 0:i.token}`},data:{owner:null==(o=this.userConfigInfo)?void 0:o.owner,repo:null==(s=this.userConfigInfo)?void 0:s.selectedRepos,path:t.path,message:"delete pictures via PicX(https://github.com/XPoet/picx)",sha:t.sha}}).then((a=>{console.log("delete res: ",a),a&&200===a.status?(t.deleting=!1,R.success("删除成功！"),e.dispatch("UPLOADED_LIST_REMOVE",t),e.dispatch("DIR_IMAGE_LIST_REMOVE",t)):t.deleting=!1}))},imageView(t){e.commit("IMAGE_VIEWER",{isShow:!0,url:t.cdn_url})}});return l({},V(t))}});$("data-v-0b8a9a12");const je={class:"image-box"},ze=["src"],Fe={class:"info-box"},Xe={class:"image-info"},Be={class:"filename"},He={class:"image-operation"},Ye={class:"delete"};j(),$e.render=function(e,t,a,n,i,o){const s=z("el-tooltip"),l=z("copy-external-link"),r=F("loading");return J((X(),B("div",{class:ne(["image-card",{listing:e.listing}]),"element-loading-text":"删除中...","element-loading-background":"rgba(0, 0, 0, 0.6)"},[ae("div",je,[ae("img",{src:e.imageObj.cdn_url,onClick:t[0]||(t[0]=t=>e.imageView(e.imageObj))},null,8,ze)]),ae("div",Fe,[ae("div",Xe,[ae("div",Be,te(e.imageObj.name),1),ae("div",He,[ae("div",Ye,[H(s,{content:"删除",placement:"top"},{default:Y((()=>[ae("i",{class:"el-icon-delete",onClick:t[1]||(t[1]=t=>e.deleteImage(e.imageObj))})])),_:1})]),ae("div",null,[H(l,{"img-obj":e.imageObj},null,8,["img-obj"])])])])])],2)),[[r,e.imageObj.deleting]])},$e.__scopeId="data-v-0b8a9a12";const Je=()=>Number(Math.random().toString().substr(2,5)+Date.now()).toString(36),qe=e=>{const t=e.lastIndexOf("."),a=e.substr(0,t),n=e.substr(t+1,e.length);return{name:a,hash:Je(),suffix:n}},We=e=>{const t=e.indexOf(".");return e.substr(0,t)},Ke=e=>/(png|jpg|gif|jpeg|webp|svg\+xml)$/.test(e),Qe=e=>Number((e/1024).toFixed(2));var Ze,et;(et=Ze||(Ze={})).uploaded="uploaded",et.allUploaded="allUploaded",et.uploadFail="uploadFail";const tt=(e,t,a)=>{const n=`https://cdn.jsdelivr.net/gh/${a.owner}/${a.selectedRepos}@${a.selectedBranch}/${t.path}`,i=decodeURI(t.download_url);switch(e){case Ge.gh:return i;case Ge.md_gh:return`![${We(t.name)}](${i})`;case Ge.cdn:return n;case Ge.md_cdn:return`![${We(t.name)}](${n})`}};var at=M({name:"selected-info-bar",setup(e,t){const a=be();return{userConfigInfo:x((()=>a.getters.getUserConfigInfo)),dirChange:e=>{t.emit("selected-dir-change",e)}}}});$("data-v-05f20ca2");const nt={key:0,class:"selected-info-bar-box"},it={class:"info-item"},ot=ee(" 仓库："),st={key:0,class:"info-item"},lt=ee(" 分支："),rt={key:1,class:"info-item"},dt=ee(" 目录： ");j(),at.render=function(e,t,a,n,i,o){const s=z("el-tag"),l=z("el-option"),r=z("el-select");return e.userConfigInfo.selectedRepos?(X(),B("div",nt,[ae("span",it,[ot,H(s,{size:"mini"},{default:Y((()=>[ee(te(e.userConfigInfo.selectedRepos),1)])),_:1})]),e.userConfigInfo.selectedBranch?(X(),B("span",st,[lt,H(s,{size:"mini"},{default:Y((()=>[ee(te(e.userConfigInfo.selectedBranch),1)])),_:1})])):W("",!0),e.userConfigInfo.selectedDir?(X(),B("span",rt,[dt,H(r,{modelValue:e.userConfigInfo.selectedDir,"onUpdate:modelValue":t[0]||(t[0]=t=>e.userConfigInfo.selectedDir=t),placeholder:"请选择",size:"mini",onChange:e.dirChange},{default:Y((()=>[(X(!0),B(Q,null,Z(e.userConfigInfo.dirList,((e,t)=>(X(),q(l,{key:t,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])])):W("",!0)])):W("",!0)},at.__scopeId="data-v-05f20ca2";var ut=M({name:"to-upload-image-card",components:{copyExternalLink:Ne,selectedInfoBar:at},props:{loadingAllImage:{type:Boolean,default:!1}},setup(){const e=be(),t=G({isShowDialog:!1,curImgInfo:null,userConfigInfo:x((()=>e.getters.getUserConfigInfo)).value,toUploadImage:x((()=>e.getters.getToUploadImage)).value,hashRename(e,t){t.filename.now=e?`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:`${t.filename.name}.${t.filename.suffix}`},rename(e,t){t.filename.name=e?t.filename.newName:t.filename.initName,t.filename.isHashRename?t.filename.now=`${t.filename.name}.${t.filename.hash}.${t.filename.suffix}`:t.filename.now=`${t.filename.name}.${t.filename.suffix}`},getFileSize:e=>`${Qe(e)} KB`,formatLastModified:e=>ke.formatTimestamp(e),async uploadImage_all(e){const t=this.toUploadImage.uploadedNumber;return t>=this.toUploadImage.list.length?Ze.uploaded:!0===await this.uploadImage_single(e,this.toUploadImage.list[t])?t<this.toUploadImage.list.length?(await this.uploadImage_all(e),Ze.allUploaded):Ze.uploaded:Ze.uploadFail},uploadImage_single(t,a){const{token:n,selectedBranch:i,email:o,owner:s}=t;a.uploadStatus.uploading=!0;const l={message:"Upload pictures via PicX(https://github.com/XPoet/picx)",branch:i,content:a.imgData.base64Content};return o&&(l.committer={name:s,email:o}),new Promise(((i,o)=>{Se.put(((e,t)=>{let a="";return"/"!==e.selectedDir&&(a=e.selectedDir+"/"),`/repos/${e.owner}/${e.selectedRepos}/contents/${a}${t}`})(t,a.filename.now),l,{headers:{"Content-Type":"application/json",Authorization:`token ${n}`}}).then((n=>{n&&201===n.status?(this.uploadedHandle(n,a,t),e.dispatch("TO_UPLOAD_IMAGE_UPLOADED",a.uuid),i(!0),R.success("上传成功！")):(a.uploadStatus.uploading=!1,i(!1),R.error("上传失败！"))})).catch((e=>{o(e)}))}))},uploadedHandle(t,a,n){a.uploadStatus.progress=100,a.uploadStatus.uploading=!1,a.externalLink.github=tt(Ge.gh,t.data.content,n),a.externalLink.cdn=tt(Ge.cdn,t.data.content,n),a.externalLink.markdown_gh=tt(Ge.md_gh,t.data.content,n),a.externalLink.markdown_cdn=tt(Ge.md_cdn,t.data.content,n);const i={uuid:a.uuid,dir:n.selectedDir,name:t.data.content.name,path:t.data.content.path,sha:t.data.content.sha,github_url:a.externalLink.github,cdn_url:a.externalLink.cdn,md_gh_url:a.externalLink.markdown_gh,md_cdn_url:a.externalLink.markdown_cdn,is_transform_md:!1,deleting:!1};a.uploadedImg=i,n.dirList.some((e=>e.value===i.dir))||(e.dispatch("USER_CONFIG_INFO_ADD_DIR",i.dir),e.dispatch("DIR_IMAGE_LIST_ADD_DIR",i.dir)),e.dispatch("UPLOADED_LIST_ADD",i),e.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",i)},imageViewer(t){e.commit("IMAGE_VIEWER",{isShow:!0,url:t})}});return r(l({},V(t)),{removeToUploadImage:t=>{e.dispatch("TO_UPLOAD_IMAGE_LIST_REMOVE",t.uuid)}})}});const ct={key:0,class:"to-upload-image-list-card"},gt={class:"header"},pt={key:0},mt={key:0,class:"body"},ft={class:"image-uploading-info-box"},It={class:"left-image-box flex-center"},ht=["onClick"],_t=["src"],Ct={class:"right-operation-box"},vt={class:"top"},Lt={class:"image-name"},Dt={class:"image-info"},bt={class:"file-size item"},Ut={class:"last-modified item"},At={key:0,class:"bottom rename-operation"},St={key:1,class:"bottom rename-operation"},kt={key:0,class:"el-icon-upload2"},Ot={key:1,class:"el-icon-loading"},Et={key:2,class:"el-icon-check"},yt=["onClick"],Tt=ae("i",{class:"el-icon-delete"},null,-1);ut.render=function(e,t,a,n,i,o){const s=z("selected-info-bar"),l=z("el-checkbox"),r=z("el-input"),d=z("copy-externalLink"),u=z("el-tooltip");return e.toUploadImage.list.length||e.userConfigInfo.selectedRepos?(X(),B("div",ct,[ae("div",gt,[ae("div",null,[H(s)]),ae("div",null,[e.toUploadImage.list.length?(X(),B("span",pt," 已上传："+te(e.toUploadImage.uploadedNumber)+" / "+te(e.toUploadImage.list.length),1)):W("",!0)])]),e.toUploadImage.list.length?(X(),B("div",mt,[ae("ul",ft,[(X(!0),B(Q,null,Z(e.toUploadImage.list,((t,a)=>(X(),B("li",{class:ne(["image-uploading-info-item",{disable:e.loadingAllImage}]),key:a},[ae("div",It,[ae("div",{class:"image-box",onClick:a=>e.imageViewer(t.imgData.base64Url)},[ae("img",{src:t.imgData.base64Url},null,8,_t)],8,ht)]),ae("div",Ct,[ae("div",vt,[ae("div",Lt,te(t.filename.now),1),ae("div",Dt,[ae("span",bt,te(e.getFileSize(t.fileInfo.size)),1),ae("span",Ut,te(e.formatLastModified(t.fileInfo.lastModified)),1)])]),t.uploadStatus.uploading||100===t.uploadStatus.progress?W("",!0):(X(),B("div",At,[H(l,{label:"哈希化",modelValue:t.filename.isHashRename,"onUpdate:modelValue":e=>t.filename.isHashRename=e,onChange:a=>e.hashRename(a,t)},null,8,["modelValue","onUpdate:modelValue","onChange"]),H(l,{label:"重命名",modelValue:t.filename.isRename,"onUpdate:modelValue":e=>t.filename.isRename=e,onChange:a=>e.rename(a,t)},null,8,["modelValue","onUpdate:modelValue","onChange"]),t.filename.isRename?(X(),q(r,{key:0,class:"rename-input",size:"mini",modelValue:t.filename.newName,"onUpdate:modelValue":e=>t.filename.newName=e,onInput:a=>e.rename(a,t),clearable:""},null,8,["modelValue","onUpdate:modelValue","onInput"])):W("",!0)])),t.uploadStatus.uploading||100!==t.uploadStatus.progress?W("",!0):(X(),B("div",St,[H(d,{"img-obj":t.uploadedImg},null,8,["img-obj"])]))]),ae("div",{class:ne(["upload-status-box",{"wait-upload":!t.uploadStatus.uploading&&100!==t.uploadStatus.progress,uploading:t.uploadStatus.uploading&&100!==t.uploadStatus.progress,uploaded:!t.uploadStatus.uploading&&100===t.uploadStatus.progress}])},[t.uploadStatus.uploading||100===t.uploadStatus.progress?W("",!0):(X(),B("i",kt)),t.uploadStatus.uploading&&100!==t.uploadStatus.progress?(X(),B("i",Ot)):W("",!0),t.uploadStatus.uploading||100!==t.uploadStatus.progress?W("",!0):(X(),B("i",Et))],2),100===t.uploadStatus.progress||t.uploadStatus.uploading?W("",!0):(X(),B("div",{key:0,class:"remove-to-upload-image",onClick:a=>e.removeToUploadImage(t)},[H(u,{effect:"dark",content:"移除",placement:"top"},{default:Y((()=>[Tt])),_:1})],8,yt))],2)))),128))])])):W("",!0)])):W("",!0)};const wt=(e,t)=>e?Ke(e.type)?new Promise((a=>{const n=new FileReader;n.readAsDataURL(e),n.onload=e=>{var n;const i=null==(n=e.target)?void 0:n.result,o=Qe(null==i?void 0:i.length);o>=t?ie.confirm(`当前图片 ${(o/1024).toFixed(2)} M，CDN 只能加速小于 30M 的图片，建议使用第三方工具 TinyPNG 压缩?`,"图片过大，禁止上传",{confirmButtonText:"前往 TinyPNG",cancelButtonText:"放弃上传"}).then((()=>{window.open("https://tinypng.com/")})).catch((()=>{console.log("放弃上传")})):a(i)}})):(R.error("该文件不是图片格式！"),null):null;var Rt=M({name:"upload-area",props:{imageLoading:{type:Boolean,default:!1}},setup(){const e=be(),t=G({uploadAreaActive:x((()=>e.getters.getUploadAreaActive)),uploadSettings:x((()=>e.getters.getUploadSettings)).value,toUploadImage:x((()=>e.getters.getToUploadImage)).value,onSelect(t){var a;e.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0);for(const e of t.target.files)null==(a=wt(e,this.uploadSettings.imageMaxSize))||a.then((t=>{this.getImage(t,e)}))},onDrop(t){var a;e.commit("CHANGE_UPLOAD_AREA_ACTIVE",!0);for(const e of t.dataTransfer.files)null==(a=wt(e,this.uploadSettings.imageMaxSize))||a.then((t=>{this.getImage(t,e)}))},async onPaste(e){const{base64:t,file:a}=await((e,t)=>e.clipboardData&&e.clipboardData.items?new Promise((a=>{for(let n=0,i=e.clipboardData.items.length;n<i;n++){const i=e.clipboardData.items[n];if("file"===i.kind){const e=i.getAsFile();wt(e,t).then((t=>{a({base64:t,file:e})}))}}})):null)(e,this.uploadSettings.imageMaxSize);this.getImage(t,a)},getImage(t,a){this.toUploadImage.list.length===this.toUploadImage.uploadedNumber&&this.toUploadImage.list.length>0&&this.toUploadImage.uploadedNumber>0&&(e.dispatch("TO_UPLOAD_IMAGE_CLEAN_LIST"),e.dispatch("TO_UPLOAD_IMAGE_CLEAN_UPLOADED_NUMBER"));const n={uuid:"",uploadStatus:{progress:0,uploading:!1},imgData:{base64Content:"",base64Url:""},fileInfo:{size:0,lastModified:0},filename:{name:"",hash:"",suffix:"",now:"",initName:"",newName:"xxx",isHashRename:!0,isRename:!1},externalLink:{github:"",cdn:"",markdown_gh:"",markdown_cdn:""}};n.imgData.base64Url=t,n.imgData.base64Content=t.split(",")[1];const{name:i,hash:o,suffix:s}=qe(a.name);n.uuid=o,n.fileInfo.size=a.size,n.fileInfo.lastModified=a.lastModified,n.filename.name=i,n.filename.hash=o,n.filename.suffix=s,n.filename.now=`${i}.${o}.${s}`,n.filename.initName=i,e.dispatch("TO_UPLOAD_IMAGE_LIST_ADD",JSON.parse(JSON.stringify(n))),e.dispatch("TO_UPLOAD_IMAGE_SET_CURRENT",{uuid:o,base64Url:t})}});return l({},V(t))}});$("data-v-ca4acc44");const Mt={key:0,for:"uploader",class:"active-upload"},Pt={key:1,class:"tips active-upload"},Gt=[ae("i",{class:"icon el-icon-upload active-upload"},null,-1),ae("div",{class:"text active-upload"},"拖拽、粘贴、或点击此处上传",-1)],xt=["src"];j(),Rt.render=function(e,t,a,n,i,o){const s=F("loading");return J((X(),B("div",{class:ne(["upload-area active-upload",{focus:e.uploadAreaActive}]),onDragover:t[1]||(t[1]=K((()=>{}),["prevent"])),onDrop:t[2]||(t[2]=K(((...t)=>e.onDrop&&e.onDrop(...t)),["stop","prevent"])),onPaste:t[3]||(t[3]=(...t)=>e.onPaste&&e.onPaste(...t)),"element-loading-text":"图片上传中...","element-loading-background":"rgba(0, 0, 0, 0.5)"},[e.uploadAreaActive?(X(),B("label",Mt)):W("",!0),ae("input",{id:"uploader",type:"file",onChange:t[0]||(t[0]=(...t)=>e.onSelect&&e.onSelect(...t)),multiple:"multiple"},null,32),e.toUploadImage.curImgBase64Url?W("",!0):(X(),B("div",Pt,Gt)),e.toUploadImage.curImgBase64Url?(X(),B("img",{key:2,class:"active-upload",src:e.toUploadImage.curImgBase64Url,alt:"Pictures to be uploaded"},null,8,xt)):W("",!0)],34)),[[s,e.imageLoading]])},Rt.__scopeId="data-v-ca4acc44";var Nt=M({name:"upload",components:{imageCard:$e,toUploadImageCard:ut,uploadArea:Rt},setup(){const e=be(),t=P(),a=oe(null),n=oe(null),i=oe(null),o=oe(null),s=G({userConfigInfo:x((()=>e.getters.getUserConfigInfo)).value,logoutStatus:x((()=>e.getters.getUserLoggingStatus)),uploadedImageList:x((()=>e.getters.getUploadedImageList)),toUploadImage:x((()=>e.getters.getToUploadImage)),imageLoading:!1}),d=()=>{s.imageLoading=!1,e.dispatch("TO_UPLOAD_IMAGE_LOGOUT")};return N((()=>s.logoutStatus),(e=>{!e&&d()})),r(l({},V(s)),{GitHubExternalLinkInput:a,CDNExternalLinkInput:n,toUploadImageCardDom:i,uploadAreaDom:o,resetUploadInfo:d,uploadImage:()=>{const{token:a,selectedRepos:n,selectedDir:o}=s.userConfigInfo;return a?n?o?void(0!==s.toUploadImage.list.length?s.toUploadImage.list.length!==s.toUploadImage.uploadedNumber?(s.imageLoading=!0,i.value.uploadImage_all(s.userConfigInfo).then((t=>{switch(t){case Ze.uploaded:case Ze.allUploaded:s.imageLoading=!1,e.dispatch("TO_UPLOAD_IMAGE_CLEAN_URL");break;case Ze.uploadFail:s.imageLoading=!1,e.dispatch("TO_UPLOAD_IMAGE_LIST_FAIL")}})).catch((e=>{console.error("upload error: ",e),s.imageLoading=!1}))):R.error("请选择要上传的图片！"):R.error("图片不能为空！")):(R.error("目录不能为空！"),void t.push("/config")):(R.error("请选择一个仓库！"),void t.push("/config")):(R.error("请先完成图床配置！"),void t.push("/config"))}})}});$("data-v-5a44ed5a");const Vt={class:"upload-page-container"},$t={key:0,class:"upload-page-left page-container",style:{width:"30%"}},jt={class:"row-item"},zt={class:"content-box"},Ft={class:"row-item"},Xt={class:"content-box"},Bt={class:"row-item"},Ht={class:"content-box",style:{"text-align":"right"}},Yt=ee("重置 "),Jt=ee("上传 ");j(),Nt.render=function(e,t,a,n,i,o){const s=z("image-card"),l=z("upload-area"),r=z("to-upload-image-card"),d=z("el-button");return X(),B("div",Vt,[e.uploadedImageList.length?(X(),B("div",$t,[(X(!0),B(Q,null,Z(e.uploadedImageList,((e,t)=>(X(),B("div",{class:"uploaded-item",key:t},[H(s,{"image-obj":e,"is-uploaded":!0},null,8,["image-obj"])])))),128))])):W("",!0),ae("div",{class:"upload-page-right page-container",style:se({width:e.uploadedImageList.length?"70%":"100%"})},[ae("div",jt,[ae("div",zt,[H(l,{"image-loading":e.imageLoading,ref:"uploadAreaDom"},null,8,["image-loading"])])]),ae("div",Ft,[ae("div",Xt,[H(r,{ref:"toUploadImageCardDom","loading-all-image":e.imageLoading},null,8,["loading-all-image"])])]),ae("div",Bt,[ae("div",Ht,[e.toUploadImage.list.length?(X(),q(d,{key:0,plain:"",size:"small",onClick:e.resetUploadInfo},{default:Y((()=>[Yt])),_:1},8,["onClick"])):W("",!0),H(d,{type:"primary",plain:"",size:"small",onClick:e.uploadImage},{default:Y((()=>[Jt])),_:1},8,["onClick"])])])],4)])},Nt.__scopeId="data-v-5a44ed5a";var qt=M({name:"management",components:{imageCard:$e,selectedInfoBar:at},setup(){const e=be(),t=P(),a=G({userConfigInfo:x((()=>e.getters.getUserConfigInfo)),loggingStatus:x((()=>e.getters.getUserLoggingStatus)),dirImageList:x((()=>e.getters.getDirImageList)),currentDirImageList:[],loadingImageList:!1,listing:!1,initDirImageList(){if(!this.dirImageList.length)return void this.getReposContent();const{selectedDir:e}=this.userConfigInfo,t=this.dirImageList.find((t=>t.dir===e));t?t.imageList.length>0?this.currentDirImageList=t.imageList:this.getDirContent(e):this.isHasDir(e)&&this.getDirContent(e)},getReposContent(){var t,a;Se.get(`/repos/${null==(t=this.userConfigInfo)?void 0:t.owner}/${null==(a=this.userConfigInfo)?void 0:a.selectedRepos}/contents`,{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((t=>{if(console.log("[getReposContent] ",t),t&&200===t.status&&t.data.length>0){e.dispatch("DIR_IMAGE_LIST_ADD_DIR","/");for(const a of t.data)"dir"===a.type?e.dispatch("DIR_IMAGE_LIST_ADD_DIR",a.name):"file"===a.type&&Ke(qe(a.name).suffix)&&e.dispatch("DIR_IMAGE_LIST_ADD_IMAGE",this.getImageObject(a,"/"));this.isHasDir(this.userConfigInfo.selectedDir)||(this.userConfigInfo.selectedDir="/"),this.dirChange(this.userConfigInfo.selectedDir)}}))},isHasDir(e){return this.userConfigInfo.dirList.some((t=>t.value===e))},getDirContent(t){var a,n;this.loadingImageList=!0;const i={dir:t,imageList:[]};Se.get(`/repos/${null==(a=this.userConfigInfo)?void 0:a.owner}/${null==(n=this.userConfigInfo)?void 0:n.selectedRepos}/contents/${t}`,{headers:{"Content-Type":"application/json",Authorization:`token ${this.userConfigInfo.token}`}}).then((a=>{if(a&&200===a.status&&a.data.length>0){const n=[];for(const e of a.data)"file"===e.type&&Ke(qe(e.name).suffix)&&n.push(this.getImageObject(e,t));i.imageList=n,e.dispatch("DIR_IMAGE_LIST_ADD_IMAGE_LIST",i),this.loadingImageList=!1}}))},getImageObject(e,t){return{uuid:Je(),dir:t,name:e.name,path:e.path,sha:e.sha,github_url:tt(Ge.gh,e,this.userConfigInfo),cdn_url:tt(Ge.cdn,e,this.userConfigInfo),md_gh_url:tt(Ge.md_gh,e,this.userConfigInfo),md_cdn_url:tt(Ge.md_cdn,e,this.userConfigInfo),deleting:!1,is_transform_md:!1}},dirChange(e){const t=this.dirImageList.find((t=>t.dir===e));t&&t.imageList.length?this.currentDirImageList=t.imageList:this.getDirContent(e)},toggleListing(){this.listing=!this.listing}});return le((()=>{a.initDirImageList()})),N((()=>a.loggingStatus),(e=>{!e&&t.push("/config")})),N((()=>a.dirImageList),(e=>{const t=e.find((e=>e.dir===a.userConfigInfo.selectedDir));t&&(a.currentDirImageList=t.imageList)}),{deep:!0}),r(l({},V(a)),{dirChange:function(e){a.dirChange(e)},reloadPics:function(){e.dispatch("DIR_IMAGE_LOGOUT"),a.initDirImageList()},toggleListing:function(){a.toggleListing()}})}});$("data-v-4ab1a09e");const Wt={class:"page-container management-page-container"},Kt={class:"content-container"},Qt={class:"top"},Zt={class:"left"},ea={class:"right flex-start"},ta={class:"bottom","element-loading-text":"加载中...","element-loading-background":"rgba(0, 0, 0, 0.5)"},aa={class:"image-list"};j(),qt.render=function(e,t,a,n,i,o){const s=z("selected-info-bar"),l=z("el-tooltip"),r=z("image-card"),d=F("loading");return X(),B("div",Wt,[ae("div",Kt,[ae("div",Qt,[ae("div",Zt,[H(s,{onSelectedDirChange:e.dirChange},null,8,["onSelectedDirChange"])]),ae("div",ea,[H(l,{placement:"top",content:e.listing?"切换方块展示":"切换列表展示"},{default:Y((()=>[ae("i",{class:ne(["btn-icon",e.listing?"el-icon-tickets":"el-icon-menu"]),onClick:t[0]||(t[0]=K(((...t)=>e.toggleListing&&e.toggleListing(...t)),["stop"]))},null,2)])),_:1},8,["content"]),H(l,{placement:"top",content:"重新加载图片"},{default:Y((()=>[ae("i",{class:"btn-icon el-icon-refresh",onClick:t[1]||(t[1]=K(((...t)=>e.reloadPics&&e.reloadPics(...t)),["stop"]))})])),_:1})])]),J(ae("div",ta,[ae("ul",aa,[(X(!0),B(Q,null,Z(e.currentDirImageList,((t,a)=>(X(),B("li",{class:"image-item",key:a,style:se({width:e.listing?"50%":"220px",height:e.listing?"80px":"230px"})},[H(r,{"image-obj":t,listing:e.listing},null,8,["image-obj","listing"])],4)))),128))])],512),[[d,e.loadingImageList]])])])},qt.__scopeId="data-v-4ab1a09e";const na={class:"tutorials-step-1"},ia=ee(" 创建一个用来存储图片的 "),oa=ae("img",{src:"https://cdn.jsdelivr.net/gh/XPoet/image-hosting@master/PicX/image.j1486dtk68n.png",alt:"Create GitHub Repository"},null,-1);var sa=M({setup(e){function t(){window.open("https://github.com/new")}return(e,a)=>(X(),B("div",na,[ae("h3",null,[ia,ae("span",{class:"go-create-repo",onClick:t}," GitHub 仓库")]),oa]))}});const la={class:"tutorials-step-2"},ra=ee(" 创建一个有 repo 权限的 "),da=ae("img",{src:"https://cdn.jsdelivr.net/gh/XPoet/image-hosting@master/PicX/image.lpt1xl9fu.png",alt:"Create GitHub Token"},null,-1),ua=ae("p",null,"然后点击 Generate token 按钮，即可生成一个token，如下图：",-1),ca=ae("img",{src:"https://cdn.jsdelivr.net/gh/XPoet/image-hosting@master/PicX/image.pzmcp6b80fk.png",alt:"token-demo"},null,-1),ga=ae("p",{style:{color:"red"}},[ae("em",null,"新生成的 Token 只会显示一次，请妥善保存！如有遗失，重新生成即可。")],-1);var pa=M({setup(e){function t(){window.open("https://github.com/settings/tokens/new")}return(e,a)=>(X(),B("div",la,[ae("h3",null,[ra,ae("span",{class:"go-create-token",onClick:t}," GitHub Token")]),da,ua,ca,ga]))}});const ma={},fa={class:"tutorials-step-3"},Ia=[re('<h3>进行图床配置（绑定 GitHub Token、存储图片的仓库和目录）</h3><p>1、填写 Token，自动获取该用户下的仓库</p><img src="https://cdn.jsdelivr.net/gh/XPoet/image-hosting@master/PicX/image.4g8q5m7c8sq0.png"><br><p>2、在仓库的下拉列表中，选择一个作为图床的仓库</p><img src="https://cdn.jsdelivr.net/gh/XPoet/image-hosting@master/PicX/image.746g75olruk0.png"><br><p>3、选择一种目录方式（目录即仓库里存放图片的文件夹）</p><img src="https://cdn.jsdelivr.net/gh/XPoet/image-hosting@master/PicX/image.5ydmhgxjhgo0.png"><div class="dir-desc-box"><ul><li>新建目录：需手动输入一个新目录。</li><li>根目录：图片将直接存储在仓库根目录下。</li><li>自动目录：自动生成日期格式 YYYYMMDD 的目录。例如：20200909</li><li>选择仓库目录：自动获取仓库下所有目录，选择一个即可。</li></ul></div>',10)];ma.render=function(e,t){return X(),B("div",fa,Ia)};var ha=M({name:"tutorials",components:{Step1:sa,Step2:pa,Step3:ma},setup(){const e=oe(0);return{stepNum:e,step:t=>{"prev"===t&&(e.value<0?e.value=0:e.value-=1),"next"===t&&(e.value>3?e.value=3:e.value+=1)}}}});$("data-v-0275023f");const _a={class:"page-container tutorials-page-container"},Ca={class:"step-content"},va={key:3},La=[ae("h2",null,"👍 恭喜你完成图床使用教程 🌟 快去试试吧~",-1),ae("h2",null,"https://github.com/XPoet/picx",-1)],Da={class:"btn-next-prev"},ba=ee("上一步 "),Ua=ee("下一步 ");j(),ha.render=function(e,t,a,n,i,o){const s=z("el-step"),l=z("el-steps"),r=z("Step1"),d=z("Step2"),u=z("Step3"),c=z("el-button");return X(),B("div",_a,[H(l,{active:e.stepNum,"finish-status":"success","align-center":""},{default:Y((()=>[H(s,{title:"创建 GitHub 仓库"}),H(s,{title:"获取 GitHub Token"}),H(s,{title:"配置图床"})])),_:1},8,["active"]),ae("div",Ca,[0===e.stepNum?(X(),q(r,{key:0})):W("",!0),1===e.stepNum?(X(),q(d,{key:1})):W("",!0),2===e.stepNum?(X(),q(u,{key:2})):W("",!0),3===e.stepNum?(X(),B("div",va,La)):W("",!0)]),ae("div",Da,[e.stepNum>0?(X(),q(c,{key:0,type:"primary",onClick:t[0]||(t[0]=t=>e.step("prev"))},{default:Y((()=>[ba])),_:1})):W("",!0),e.stepNum<3?(X(),q(c,{key:1,type:"primary",onClick:t[1]||(t[1]=t=>e.step("next"))},{default:Y((()=>[Ua])),_:1})):W("",!0)])])},ha.__scopeId="data-v-0275023f";const Aa=[{path:"/",name:"index",redirect:{name:"upload"}},{path:"/config",name:"config",component:Oe,meta:{title:"图床配置 | PicX 图床神器"}},{path:"/upload",name:"upload",component:Nt,meta:{title:"图片上传 | PicX 图床神器"}},{path:"/management",name:"Management",component:qt,meta:{title:"图床管理 | PicX 图床神器"}},{path:"/tutorials",name:"tutorials",component:ha,meta:{title:"使用教程 | PicX 图床神器"}},{path:"/about",name:"about",component:()=>fe((()=>import("./about.9b9fc2ad.js")),["assets/about.9b9fc2ad.js","assets/about.a5c44f06.css","assets/vendor.f122fabb.js","assets/vendor.73c4a0ce.css"]),meta:{title:"帮助反馈 | PicX 图床神器"}}],Sa=de({history:ue(),routes:Aa});Sa.beforeEach(((e,t,a)=>{e.meta.title&&(window.document.title=e.meta.title),a()}));var ka=M({name:"site-count",props:{isuv:{type:Boolean,default:!1}},setup(){const e=oe(null);return le((()=>{const t=document.createElement("script");t.async=!0,t.src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js",e.value.appendChild(t)})),{siteCountDom:e}}});const Oa={class:"site-count",ref:"siteCountDom"},Ea={key:0,id:"busuanzi_value_site_uv"},ya={key:1,id:"busuanzi_value_site_pv"};ka.render=function(e,t,a,n,i,o){return X(),B("span",Oa,[e.isuv?(X(),B("span",Ea)):W("",!0),e.isuv?W("",!0):(X(),B("span",ya))],512)};var Ta=M({name:"header-content",components:{siteCount:ka},setup(){const e=P(),t=be(),a=G({defaultUsername:"未登录",userConfigInfo:x((()=>t.state.userConfigInfoModule.userConfigInfo))});return r(l({},V(a)),{router:e,onUserInfoClick:()=>{a.userConfigInfo.loggingStatus||"/config"===e.currentRoute.value.path||e.push("/config")},handleCommand:a=>{switch(a){case"upload":e.push("/");break;case"config":e.push("/config");break;case"management":e.push("/management");break;case"logout":t.dispatch("LOGOUT"),e.push("/config")}},goGitHubRepo:()=>{window.open("https://github.com/XPoet/picx")}})}});$("data-v-d9c0f5f6");const wa={class:"header"},Ra={class:"header-left"},Ma=[ae("div",{class:"logo"},[ae("img",{src:"./assets/logo.206d082d.png",alt:"PicX"})],-1),ae("div",{class:"title"},"PicX",-1)],Pa={class:""},Ga=ee(" 有 "),xa=ee(" 位小伙伴使用 PicX 图床神器 "),Na={class:"header-right"},Va={class:"username"},$a={key:0,class:"avatar"},ja=[ae("i",{class:"el-icon-user-solid"},null,-1)],za={class:"el-dropdown-link"},Fa={class:"avatar"},Xa=["src","alt"],Ba=ee(" 退出登录 ");j(),Ta.render=function(e,t,a,n,i,o){var s,l;const r=z("site-count"),d=z("el-tooltip"),u=z("el-dropdown-item"),c=z("el-dropdown-menu"),g=z("el-dropdown");return X(),B("header",wa,[ae("div",Ra,[ae("div",{class:"brand",onClick:t[0]||(t[0]=t=>e.router.push("/"))},Ma),ae("div",{class:"website-count",onClick:t[1]||(t[1]=(...t)=>e.goGitHubRepo&&e.goGitHubRepo(...t))},[H(d,{effect:"light",content:"点个 Star 支持一下作者吧(*￣︶￣)",placement:"bottom"},{default:Y((()=>[ae("i",Pa,[Ga,H(r,{isuv:!1}),xa])])),_:1})])]),ae("div",Na,[ae("div",{class:"user-info",onClick:t[2]||(t[2]=(...t)=>e.onUserInfoClick&&e.onUserInfoClick(...t))},[ae("div",Va,te(e.userConfigInfo.owner?e.userConfigInfo.owner:e.defaultUsername),1),(null==(s=e.userConfigInfo)?void 0:s.avatarUrl)?W("",!0):(X(),B("div",$a,ja)),(null==(l=e.userConfigInfo)?void 0:l.avatarUrl)?(X(),q(g,{key:1,trigger:"click",onCommand:e.handleCommand},{dropdown:Y((()=>[H(c,null,{default:Y((()=>[H(u,{command:"logout"},{default:Y((()=>[Ba])),_:1})])),_:1})])),default:Y((()=>{var t,a;return[ae("span",za,[ae("span",Fa,[ae("img",{src:null==(t=e.userConfigInfo)?void 0:t.avatarUrl,alt:null==(a=e.userConfigInfo)?void 0:a.owner},null,8,Xa)])])]})),_:1},8,["onCommand"])):W("",!0)])])])},Ta.__scopeId="data-v-d9c0f5f6";var Ha=M({name:"nav-content",setup(){const e=P(),t=be(),a=G({userConfigInfo:x((()=>t.getters.getUserConfigInfo)).value,navList:[{name:"图床配置",icon:"el-icon-edit-outline",isActive:!1,path:"/config"},{name:"上传图片",icon:"el-icon-upload2",isActive:!1,path:"/upload"},{name:"图床管理",icon:"el-icon-box",isActive:!1,path:"/management"},{name:"使用教程",icon:"el-icon-magic-stick",isActive:!1,path:"/tutorials"},{name:"帮助反馈",icon:"el-icon-chat-dot-round",isActive:!1,path:"/about"}],navClick(t){const{path:a}=t;if("/management"===a){if(""===this.userConfigInfo.selectedRepos)return R.warning("请选择一个仓库！"),void e.push("/config");if(""===this.userConfigInfo.selectedDir)return R.warning("目录不能为空！"),void e.push("/config")}e.push(a)}}),n=e=>{a.navList.forEach((t=>{const a=t;return a.isActive=t.path===e,a}))};return N((()=>e.currentRoute.value),(e=>{n(e.path)})),le((()=>{e.isReady().then((()=>{n(e.currentRoute.value.path)}))})),l({},V(a))}});$("data-v-de3f52d0");const Ya={class:"nav"},Ja={class:"nav-list"},qa=["onClick"],Wa={class:"nav-content"},Ka={class:"nav-name"};j(),Ha.render=function(e,t,a,n,i,o){return X(),B("aside",Ya,[ae("ul",Ja,[(X(!0),B(Q,null,Z(e.navList,((t,a)=>J((X(),B("li",{class:ne(["nav-item flex-center",{active:t.isActive}]),key:a,onClick:a=>e.navClick(t)},[ae("div",Wa,[ae("i",{class:ne(["nav-icon",t.icon])},null,2),ae("span",Ka,te(t.name),1)])],10,qa)),[[ce,"/management"!==t.path||e.userConfigInfo.loggingStatus]]))),128))])])},Ha.__scopeId="data-v-de3f52d0",$("data-v-4b7f3a64");const Qa={key:0,class:"image-box"},Za=["src"];j();var en=M({setup(e){const t=be(),a=x((()=>t.getters.getImageViewer));return(e,t)=>(X(),B("div",{class:ne(["image-viewer",{active:ge(a).isShow}]),onClick:t[0]||(t[0]=e=>ge(a).isShow=!1)},[ge(a).url?(X(),B("div",Qa,[ae("img",{class:"img",src:ge(a).url},null,8,Za)])):W("",!0)],2))}});en.__scopeId="data-v-4b7f3a64";var tn=M({name:"main-container",components:{headerContent:Ta,navContent:Ha,imageViewer:en},setup(){const e=be();return{changeUploadAreaActive:t=>{e.commit("CHANGE_UPLOAD_AREA_ACTIVE",t.target.classList.contains("active-upload"))}}}});$("data-v-7407492c");const an={class:"top"},nn={class:"bottom"},on={class:"container"},sn={class:"left"},ln={class:"right"},rn={class:"content"};j(),tn.render=function(e,t,a,n,i,o){const s=z("header-content"),l=z("nav-content"),r=z("router-view"),d=z("image-viewer");return X(),B(Q,null,[ae("main",{class:"main-container",onClick:t[0]||(t[0]=(...t)=>e.changeUploadAreaActive&&e.changeUploadAreaActive(...t))},[ae("div",an,[H(s)]),ae("div",nn,[ae("div",on,[ae("div",sn,[H(l)]),ae("div",ln,[ae("div",rn,[H(r)])])])])]),H(d)],64)},tn.__scopeId="data-v-7407492c";var dn=M({name:"App",components:{mainContainer:tn}});dn.render=function(e,t,a,n,i,o){const s=z("main-container");return X(),q(s)};fe((()=>import("./register-sw.74361854.js")),[]);const un=pe(dn);var cn;cn=un,[d,u,c,g,p,m,f,I,h,_,C,v,L,D,b,U,A,S,k,O,E].forEach((e=>{cn.use(e)})),un.use(Sa).use(Le,De).mount("#app");
